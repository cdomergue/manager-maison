<div class="settings-container">
  <!-- En-t√™te avec bouton de retour -->
  <div class="header-with-back">
    <button class="back-btn" routerLink="/" title="Retour √† l'accueil">
      ‚Üê Retour
    </button>
    <h2>Param√®tres</h2>
  </div>

  <!-- Statut du serveur -->
  <div class="section">
    <h3>Statut du serveur</h3>
    <div class="status-card">
      <div class="status-item">
        <span class="label">Connexion :</span>
        <span class="value" [class.connected]="isServerConnected()" [class.disconnected]="!isServerConnected()">
          {{ connectionStatus() }}
        </span>
        <button class="refresh-btn" (click)="refreshServerStatus()" [disabled]="connectionStatus() === 'V√©rification...'">
          üîÑ
        </button>
      </div>

      @if (serverStatus()) {
        <div class="status-item">
          <span class="label">T√¢ches totales :</span>
          <span class="value">{{ serverStatus().totalTasks }}</span>
        </div>

        <div class="status-item">
          <span class="label">Derni√®re mise √† jour :</span>
          <span class="value">{{ serverStatus().lastUpdated | date:'dd/MM/yyyy HH:mm' }}</span>
        </div>

        <div class="status-item">
          <span class="label">Heure du serveur :</span>
          <span class="value">{{ serverStatus().serverTime | date:'dd/MM/yyyy HH:mm:ss' }}</span>
        </div>
      }
    </div>
  </div>

  <!-- V√©rification en arri√®re-plan -->
  <div class="section">
    <h3>V√©rification en arri√®re-plan</h3>
    <div class="status-card">
      <div class="status-item">
        <span class="label">Statut :</span>
        <span class="value" [class.connected]="!isCheckingBackground()" [class.disconnected]="isCheckingBackground()">
          {{ isCheckingBackground() ? 'V√©rification en cours...' : 'Actif' }}
        </span>
        <button class="refresh-btn" (click)="forceBackgroundCheck()" [disabled]="isCheckingBackground()">
          üîç
        </button>
      </div>

      @if (lastBackgroundCheck()) {
        <div class="status-item">
          <span class="label">Derni√®re v√©rification :</span>
          <span class="value">{{ lastBackgroundCheck() | date:'HH:mm:ss' }}</span>
        </div>
      }

      <div class="status-item">
        <span class="label">Intervalle :</span>
        <span class="value">{{ backgroundCheckInterval() / 1000 }} secondes</span>
      </div>
    </div>
  </div>

  <!-- Stockage local -->
  <div class="section">
    <h3>Stockage local</h3>
    <div class="storage-info">
      <p>Taille utilis√©e : {{ storageSize() | number }} octets</p>
      <button class="danger-btn" (click)="clearLocalStorage()">
        Effacer toutes les donn√©es locales
      </button>
    </div>
  </div>

  <!-- Informations -->
  <div class="section">
    <h3>Informations</h3>
    <div class="info-card">
      <p><strong>Mode de fonctionnement :</strong></p>
      <ul>
        @if (isServerConnected()) {
          <li>‚úÖ Mode serveur : Les donn√©es sont synchronis√©es avec le serveur local</li>
        }
        @else {
          <li>‚ö†Ô∏è Mode local : Les donn√©es sont stock√©es uniquement dans le navigateur</li>
        }
      </ul>

      <p><strong>Partage des donn√©es :</strong></p>
      <ul>
        @if (isServerConnected()) {
          <li>‚úÖ Les t√¢ches sont partag√©es entre tous les utilisateurs connect√©s au serveur</li>
        }
        @else {
          <li>‚ùå Les t√¢ches ne sont pas partag√©es (mode hors ligne)</li>
        }
      </ul>
    </div>
  </div>
</div>
